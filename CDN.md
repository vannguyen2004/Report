## CND là gì
- Hiện tại trên mạng internet hiện nay thì phần lớn và truyền dữ liệu dạng media (thường là video hoặc audio) từ một nguồn (Content Provider) đến hàng triệu người dùng (Content Customer). CDN là công nghệ mà cho phép kết nối one-to-many hiệu quả. A CDN là hệ thống phân tán của server cho việc vận chuyển nội dung trên HTTPS. Các Server được deploy trên nhiều vị trí khác nhau với mục đích tối ưu việc vận chuyển nội dung đến end user. Trong khi ít lưu lượng trên mạng.
- Đặt trưng của CDN bao gồm những thứ sau:
-   + Cache server: là một máy chủ vừa làm nhiệm vụ proxy các yêu cầu, vừa lưu trữ dữ liệu để tái sử dụng. Traffic Control sử dụng **Apache traffic Server** để cung cấp các Cache Server
    + Content Router: Content user đảm bảo rằng các end user được kết nối đến các Cache Server tối ưu cho vị trí của end user và khả năng có sẳn nội dung. Traffic Control sử dụng **Traffic Router** as a content router
    + The **Health Protocol**:giao thức Health giám sác việc sử dụng các Cache Server và các máy chủ thuê bao (tenants) trong mạng CDN
    + Configuration Management System: trong nhiều trường hợp CDN bao gồm hàng trăm hoặc thậm chí hàng triệu server phân bốc trên khu vực địa lí lớn. Trong các trường hợp như vậy, việc cấu hình thủ công là việc không thực tế. Vì vậy sẽ có một cơ quan trung ương (central authority) quản lí cấu hình được sử dụng để tự động hóa các công việc càng nhiều càng tốt. Traffic Ops quản lí điều này thông qua **Traffic Portal**
    + Log file Analysis System: Thống kê và phân tích vô cùng quan trọng trong việc quản lí và quản tị của CDN. Transaction logs và Usage Statistics cho Tranffic Control gói gọn trong **Traffic Stats**
## HTTP/1.1
  - Để có cái nhìn tổng quan về traffic control . Một điều quan trọng là hiểu cơ bản giao thức **HTTP/1.1** hoạt động như thế và chức năng của **Cache Server**
  - Dưới đây là chuỗi các sự kiện diễn ra khi một máy khác yêu cầu nội dung từ một máy chủ chạy **HTTP/1.1**
  - + Client gửi yêu cầu đến LDNS server để phân giải tên ***www.origin.com*** thành địa chi IP và gửi HTTP request đến địa chỉ IP đó. (Một phản hồi DNS kèm với TTL chỉ ra kết quả phân giải tên miền được coi là hợp lệ mặc dù TTL dài như một ngà hoặc lâu hơn là khá phổ biến trong trường hợp khác. Tuy nhiên trong CDN thì TTL DNS thường là một phút.
    + Server tại ***www.origin.com*** tìm kiếm đường dẫn (path) và gửi nó trong phản hồi đến Client
## Cache Control Headers and Revalidation
  - Cụ thể trong tài liệu RFC2616#section-14.9 của HTTP/1.1, cho phép các máy chủ gốc và khách hàng tác động đến cache xử lý các yêu cầu và phản hồi của họ. Mặc định trong hệ thống CDN traffic Control sẽ tôn trọng các tiêu đề điều khiển Cache (Cache control Headers) thông thường, các máy chủ gốc sẽ chỉ định cho các cache downtream (cache phía dưới) biết thời gian mà một phản hồi có thể được lưu trữ (Cached) Điều khiển cache bằng các truy cập vào header
  - Chỉ thị max-age trong tiêu đề Cache-Control thông báo cho các hệ thống cache phía dưới (downstream caches) rằng thời gian tối đa mà họ được phép lưu trữ phản hồi này là số giây được chỉ định. Máy chủ gốc cũng có thể thêm tiêu đề Expires:, chỉ rõ thời gian mà phản hồi này sẽ hết hạn. Khi một phản hồi hết hạn, nó thường không bị xóa khỏi cache, nhưng khi có một yêu cầu đến mà nếu không hết hạn thì sẽ truy cập vào phản hồi đó, cache sẽ thực hiện kiểm tra lại (revalidation) phản hồi. Cụ thể, đây là cách ATS (Apache Traffic Server) xử lý việc kiểm tra lại nội dung. Thay vì yêu cầu lại đối tượng từ máy chủ gốc, cache sẽ gửi yêu cầu đến máy chủ gốc, thông báo phiên bản của phản hồi mà cache đang có và hỏi xem nó có thay đổi hay không. Nếu có thay đổi, máy chủ sẽ gửi phản hồi 200 OK kèm dữ liệu mới. Nếu không thay đổi, máy chủ gốc sẽ gửi phản hồi 304 Not Modified, thông báo rằng phản hồi vẫn hợp lệ và cache có thể đặt lại bộ đếm thời gian cho việc hết hạn của phản hồi. Để chỉ ra phiên bản mà khách hàng (cache) có, nó sẽ thêm một tiêu đề If-Not-Modified-Since: hoặc If-None-Match:. Ví dụ, trong trường hợp If-None-Match:, máy chủ gốc sẽ gửi một tiêu đề ETag để xác định duy nhất phản hồi. Sau đó, khách hàng có thể sử dụng giá trị ETag này trong yêu cầu kiểm tra lại (revalidation request) để kiểm tra xem ETag của nội dung yêu cầu có thay đổi hay không.
